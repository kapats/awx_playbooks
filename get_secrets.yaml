---
- name: Get password from SSM
  hosts: localhost
  gather_facts: False
  tasks:
      - name: get secret
        set_fact:
          secret: "{{ lookup('aws_ssm', '/tests/karol/ansible_secret', region='eu-central-1') }}"

      # - name: Add secret to credential store
      #   awx.awx.credential:
      #     name: test_credential
      #     organization: Default
      #     credential_type: Database password
      #     inputs:
      #       db_pass: "{{ secret }}"

    - name: "Set a fact to share across jobs"
      set_stats:
        data:
          shared_secret: "This is a hardcoded secred"